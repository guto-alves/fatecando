<!DOCTYPE html>
<html xmlns:th="www.thymeleaf.org"
	th:replace="~{fragments/layout :: base('Ticket de Suporte', ~{::body}, _, _, _)}">
<head>
<meta charset="utf-8">
</head>
<body>
	<div class="container mt-3">
		<div class="row justify-content-center">
			<div class="col-md-8">
				<nav style="-bs-breadcrumb-divider: '&gt;';" aria-label="breadcrumb">
					<ol class="breadcrumb">
						<li class="breadcrumb-item">
							<a href="#" class="link-dark" th:href="@{/support}">Suporte</a>
						</li>
						<li class="breadcrumb-item active" aria-current="page">Ticket de Suporte</li>
					</ol>
				</nav>

				<h3 class="fw-bold border-5 border-danger border-start ps-2">[[${ticket.id}]]# Ticket</h3>

				<hr>

				<div class="card mb-3">
					<div class="card-body">
						<div class="row mb-2">
							<span class="text-muted col-sm-2 col-form-label">Categoria</span>
							<div class="col-sm-10">
								<span class="form-control" th:text="${ticket.category.displayName}"></span>
							</div>
						</div>
						<div class="row mb-2">
							<span class="text-muted col-sm-2 col-form-label">Assunto</span>
							<div class="col-sm-10">
								<span class="form-control " th:text="${ticket.title}"></span>
							</div>
						</div>
						<div class="mb-2">
							<span class="text-muted">Descrição</span>
							<div id="description-editor" th:utext="${ticket.description}"></div>
						</div>
					</div>
				</div>

				<div class="responses">
					<div class="list-group list-group-numbered">
						<div class="list-group-item d-flex justify-content-between align-items-start"
							th:each="response : ${responses}">
							<div class="ms-2 me-auto">
								<div class="fw-bold mb-3"
									th:text="${response.user.fullName + ' - ' + #dates.format(response.date, 'dd/MM/yyyy HH:mm')}">Subheading</div>
								<div>[[${response.content}]]</div>
							</div>
						</div>
					</div>
				</div>

				<div class="mt-5">
					<div class=""></div>
					<form id="response-form" action="#" method="post" th:object="${response}">
						<label for="content">Sua resposta</label>
						<textarea rows="2" class="form-control mb-3" th:field="*{content}" required></textarea>

						<div class="d-grid gap-2 col-md-6 mx-auto">
							<button type="submit" class="btn btn-danger">Responder</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>

	<script th:src="@{/js/quill-utils.js}"></script>

	<script type="text/javascript">
		let descriptionEditor = new Quill('#description-editor',
				EditorOptions.READ_ONLY);

		$('#ticket-form').submit(function(event) {
			$('#description').val(descriptionEditor.root.innerHTML);
		});
	</script>
</body>
</html>